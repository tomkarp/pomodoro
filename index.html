<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Pomodoro Timer</title>
    <link rel="stylesheet" href="styles.css">
  </head>
  <body>
    <div id="elm"></div>
    <script src="elm.js"></script>
    <script>
      // Safari-Audio-Workaround: Einmaliges Audio-Element fÃ¼r alle Sounds
      let unlocked = false;
      let audioElem = document.createElement('audio');
      audioElem.src = 'https://assets.mixkit.co/active_storage/sfx/270/270-preview.mp3';
      audioElem.volume = 0.8;
      document.body.appendChild(audioElem);

      document.body.addEventListener('click', function unlockAudio() {
        if (!unlocked) {
          audioElem.muted = true;
          audioElem.play().finally(() => {
            audioElem.pause();
            audioElem.currentTime = 0;
            audioElem.muted = false;
            unlocked = true;
          });
        }
      }, { once: true });

      var app = Elm.Main.init({
        node: document.getElementById('elm')
      });

      app.ports.playSound.subscribe(function() {
        if (unlocked) {
          audioElem.currentTime = 0;
          audioElem.play().catch(() => {});
        }
      });
    </script>
  </body>
</html>