<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Pomodoro Timer</title>
    <link rel="stylesheet" href="styles.css">
  </head>
  <body>
    <div id="elm"></div>
    <script src="elm.js"></script>
    <script>
      // Safari-Audio-Workaround: AudioContext nach erstem User-Click unlocken
      let unlocked = false;
      document.body.addEventListener('click', function unlockAudio() {
        if (!unlocked) {
          let ctx = new (window.AudioContext || window.webkitAudioContext)();
          let source = ctx.createBufferSource();
          source.buffer = ctx.createBuffer(1, 1, 22050);
          source.connect(ctx.destination);
          source.start(0);
          unlocked = true;
        }
      }, { once: true });

      var app = Elm.Main.init({
        node: document.getElementById('elm')
      });

      app.ports.playSound.subscribe(function() {
        const audio = new Audio('https://assets.mixkit.co/active_storage/sfx/270/270-preview.mp3');
        audio.volume = 0.8;
        audio.play().catch(error => console.error('Fehler beim Abspielen des Sounds:', error));
      });
    </script>
  </body>
</html>